{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Appointment - iSecorm Clinic</title>
    <link rel="stylesheet" href="{% static 'css/header_footer.css' %}?v={% now 'U' %}">
    <link rel="stylesheet" href="{% static 'css/appointment_form.css' %}?v={% now 'U' %}">
    <link rel="stylesheet" href="{% static 'css/body.css' %}?v={% now 'U' %}">
    <script src="{% static 'js/script.js' %}?v={% now 'U' %}" defer></script>
    <script src="{% static 'js/menu.js' %}" defer></script>
    <script src="{% static 'js/animations.js' %}"></script>
</head>
<body>
    <!-- Messages Display -->
    <!-- {% if messages %}
        <div style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
            {% for message in messages %}
                <div style="background: {% if message.tags == 'error' %}#f8d7da{% elif message.tags == 'success' %}#d4edda{% else %}#d1ecf1{% endif %}; 
                           color: {% if message.tags == 'error' %}#721c24{% elif message.tags == 'success' %}#155724{% else %}#0c5460{% endif %}; 
                           padding: 12px 20px; margin-bottom: 10px; border-radius: 5px; 
                           border: 1px solid {% if message.tags == 'error' %}#f5c6cb{% elif message.tags == 'success' %}#c3e6cb{% else %}#bee5eb{% endif %}; 
                           box-shadow: 0 2px 8px rgba(0,0,0,0.1); max-width: 300px;">
                    <button onclick="this.parentElement.style.display='none'" style="float: right; background: none; border: none; font-size: 18px; cursor: pointer; margin-left: 10px;">&times;</button>
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %} -->

    <header>
      <div class="top-bar">
        <div class="top-fill"></div>
      </div>

      <nav class="navbar">
        <div class="nav-logo">
          <img src="{% static 'images/logo.png' %}" alt="iSercom" />
        </div>
        <button class="hamburger" id="hamburger">&#9776;</button>
        <div class="nav-links" id="navLinks">
          <a href="{% url 'home' %}">Home</a>
          <a href="{% url 'about_us' %}">About Us</a>
          <a href="{% url 'contact' %}">Contact Us</a>
          <a href="{% url 'services' %}">Services</a>

          {% if user.is_authenticated %}
            <a href="{% url 'logout' %}" class="appointment">Sign Out</a>
          {% else %}
            <a href="{% url 'login' %}" class="appointment">Login</a>
          {% endif %}
          
        </div>
      </nav>
    </header>

    <main style="height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; font-family: Arial, sans-serif; background-color: #D9D9D9;">
        <form class="select" method="post" action="{% url 'create_appointment' %}">
            {% csrf_token %}
            <h1>Book Your Appointment</h1>
            
            <!-- Display form errors -->
            {% if form.errors %}
                <div style="margin-bottom: 20px;">
                    {% for field in form %}
                        {% for error in field.errors %}
                            <p style="color: #d32f2f; font-size: 14px; margin: 5px 0;">{{ field.label }}: {{ error }}</p>
                        {% endfor %}
                    {% endfor %}
                    {% for error in form.non_field_errors %}
                        <p style="color: #d32f2f; font-size: 14px; margin: 5px 0;">{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}
            
            <div class="form-row">
                <div class="form-group">
                    <label for="id_date">Select Date</label>
                    <input type="date" id="id_date" name="date" value="{{ form.date.value|default:'' }}" 
                           min="{% now 'Y-m-d' %}" required>
                </div>
                <div class="form-group">
                    <label for="id_time">Select Time (6:30 AM - 9:00 PM)</label>
                    <input type="time" id="id_time" name="time" value="{{ form.time.value|default:'' }}" 
                           min="06:30" max="21:00" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="id_doctor">Select Doctor</label>
                    <select id="id_doctor" name="doctor" required>
                        <option value="">Choose a doctor...</option>
                        {% for doctor in doctors %}
                            <option value="{{ doctor.id }}" {% if form.doctor.value == doctor.id %}selected{% endif %}>
                                Dr. {{ doctor.user.first_name }} {{ doctor.user.last_name }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="id_service">Select Service</label>
                    <select id="id_service" name="service" required>
                        <option value="">Choose a service...</option>
                        {% for service in services %}
                            <option value="{{ service.id }}" {% if form.service.value == service.id %}selected{% endif %}>
                                {{ service.name }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="id_notes">Notes/Message</label>
                    <textarea id="id_notes" name="notes" placeholder="Enter your name, notes, or any specific concerns for this appointment" rows="4">{{ form.notes.value|default:'' }}</textarea>
                </div>
            </div>
            
            <div class="pick-container">
                <button type="submit" class="pick" id="sent">Book Appointment</button>
                <a href="#" class="pick" id="appbook" style="text-decoration: none; display: inline-flex; align-items: center; justify-content: center;">Cancel</a>
            </div>
        </form>
    </main>

    <footer class="footer">
        <div class="footer-top">
            <img src="{% static 'images/logo.png' %}" alt="iSecorm Logo" class="logo">
            <button class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">Back to top</button>
        </div>
        <div class="footer-content">
            <div class="related-pages">
                <h3>Related Pages</h3>
                <ul>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Contact Us</a></li>
                    <li><a href="#">Learn More</a></li>
                </ul>
            </div>
            <div class="quick-links">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#">Obstetrics and Gynaecological Services</a></li>
                    <li><a href="#">Consultation & Specialised Clinics</a></li>
                    <li><a href="#">Antenatal Care</a></li>
                    <li><a href="#">Fertility/IVF</a></li>
                </ul>
            </div>
            <div class="follow-us">
                <h3>Follow Us</h3>
                <div class="icons">
                    <a href="#" aria-label="Facebook"><img src="{% static 'images/facebook.png' %}" alt="Facebook"></a>
                    <a href="#" aria-label="TikTok"><img src="{% static 'images/Tiktok.png' %}" alt="TikTok"></a>
                    <a href="#" aria-label="Instagram"><img src="{% static 'images/instagram.png' %}" alt="Instagram"></a>
                    <a href="#" aria-label="Twitter"><img src="{% static 'images/X.png' %}" alt="X"></a>
                </div>
                <form class="feedback-form" method="post" action="{% url 'contact' %}">
                    {% csrf_token %}
                    <textarea placeholder="Your feedback" name="feedback" required></textarea>
                    <div class="form-row">
                        <input type="text" placeholder="Your name" name="name" required>
                        <input type="email" placeholder="Your email" name="email" required>
                    </div>
                    <button type="submit">Send Feedback</button>
                </form>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 iSecorm Clinic. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>